# 与AI的睡前故事 2 - 微内核架构版

> 🎉 **重大更新**：应用已成功重构为微内核+插件化架构！

## 🌟 什么改变了？

### 从单一应用到可扩展平台

**之前**：一个固定功能的聊天应用
```
App.vue (2000+ 行)
  └── 所有功能都耦合在一起
```

**现在**：可扩展的AI能力平台
```
微内核 AppCore
  ├── 标准对话模式（原功能）
  ├── 虚拟恋人模式（即将推出）
  ├── 游戏模式（即将推出）
  └── 更多模式...
```

## 🚀 新架构优势

### 1. 高度模块化
- ✅ 每个功能都是独立插件
- ✅ 修改一个不影响其他
- ✅ 代码清晰易维护

### 2. 无限扩展性
- ✅ 轻松添加新模式（虚拟恋人、游戏、小说等）
- ✅ 可插拔的工具系统（骰子、生图、语音等）
- ✅ 支持第三方插件（未来）

### 3. 开发效率高
- ✅ 共享组件库，避免重复代码
- ✅ 核心服务统一管理
- ✅ 插件可并行开发

### 4. 向后兼容
- ✅ 所有原有功能完整保留
- ✅ 数据自动迁移
- ✅ 用户体验一致

## 📁 新目录结构

```
src/
├── core/                      # 🎯 微内核核心
│   ├── services/
│   │   └── aiService.js       # 统一的AI服务接口
│   ├── pluginSystem.js        # 插件注册与管理
│   └── store.js               # 全局状态管理
│
├── modes/                     # 🔌 模式插件
│   ├── StandardChatMode/      # 标准对话（原功能）
│   │   ├── index.vue
│   │   ├── plugin.js
│   │   └── components/
│   └── index.js               # 模式注册中心
│
├── shared/                    # 🎨 共享资源
│   └── components/
│       ├── MessageBubble.vue  # 消息气泡
│       ├── ChatInput.vue      # 输入框
│       ├── MarkdownRenderer.vue
│       └── EmptyState.vue
│
├── tools/                     # 🔧 工具插件
│   ├── ScriptSelectorTool/    # 剧本选择器
│   └── index.js               # 工具注册中心
│
├── AppCore.vue                # 微内核主应用
└── main.js                    # 应用入口
```

## 🎯 即将推出的功能

基于新架构，这些功能变得触手可及：

### 新模式
- 🌹 **虚拟恋人模式**
  - 好感度系统
  - 送礼互动
  - 特殊事件触发
  
- 🎮 **游戏模式**
  - 骰子检定系统
  - 角色属性管理
  - 战斗系统
  
- 📖 **小说模式**
  - 章节管理
  - 大纲生成
  - 角色卡管理

### 新工具
- 🎲 **骰子工具** - 支持各种TRPG规则
- 🎨 **生图工具** - AI绘图集成
- 🗣️ **语音工具** - TTS/STT支持
- 💻 **代码运行** - 在线代码执行

## 📚 文档

完整的文档已就绪：

1. **[快速开始](docs/快速开始.md)** - 5分钟上手新架构
2. **[架构说明](docs/架构说明.md)** - 详细的架构设计
3. **[插件开发示例](docs/插件开发示例.md)** - 虚拟恋人、骰子等完整示例
4. **[重构指南](REFACTORING_GUIDE.md)** - 重构细节和变化说明

## 🚀 快速开始

### 安装和运行

```bash
# 克隆项目
git clone <repository-url>
cd Bedtime-Stories-with-AI-2

# 安装依赖
npm install

# 开发模式（热重载）
npm run dev

# 构建生产版本
npm run build
```

### 开发你的第一个插件

只需 5 分钟！参考 [快速开始文档](docs/快速开始.md)

```javascript
// 1. 创建插件目录
src/modes/YourMode/

// 2. 实现组件
// 3. 注册插件
// 4. 完成！
```

## 🎨 示例截图

### 标准对话模式
![标准对话](docs/images/standard-chat.png)
*经典的AI对话功能*

### 模式选择器
![模式选择](docs/images/mode-selector.png)
*轻松切换不同模式*

### 虚拟恋人模式（概念图）
![虚拟恋人](docs/images/virtual-lover-concept.png)
*即将推出的新模式*

## 🤝 贡献

欢迎贡献新的插件！

1. Fork 本项目
2. 创建你的插件
3. 提交 Pull Request
4. 我们会 review 并合并

查看 [插件开发示例](docs/插件开发示例.md) 了解如何创建插件。

## 📊 技术栈

- **前端框架**: Vue 3 (Composition API)
- **UI库**: Element Plus
- **样式**: Tailwind CSS
- **架构**: 微内核 + 插件化
- **AI服务**: 支持多种提供商（Gemini、DeepSeek等）

## 🔮 未来规划

### 短期（1-2周）
- [ ] 完善标准对话模式
- [ ] 实现虚拟恋人模式
- [ ] 添加骰子工具

### 中期（1-2月）
- [ ] 游戏模式
- [ ] 小说模式
- [ ] 生图工具
- [ ] 插件市场原型

### 长期（3-6月）
- [ ] 插件市场
- [ ] 第三方插件支持
- [ ] 移动端适配
- [ ] 多语言支持

## 📄 License

保持原项目 License

## 👏 致谢

感谢所有用户的支持和反馈！

## 📮 联系方式

- 作者: tobenot
- QQ群: 1028122611（作者粉丝群）

---

**享受全新的架构，创造无限可能！** 🚀✨

*现在就开始开发你的第一个插件吧！*

