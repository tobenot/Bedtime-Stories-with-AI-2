# 快速开始指南

## 🎯 重构完成！

你的应用已成功升级为**微内核+插件化架构**！

## ✨ 新架构亮点

### 1. 模块化设计
```
🎯 微内核 (AppCore)
  ├── 🔌 插件系统
  ├── 🎨 共享组件库
  └── 🛠️ 核心服务
```

### 2. 三大核心模块

#### 📦 模式插件 (Modes)
完整的功能模块，如：
- ✅ 标准对话模式（已完成）
- 🌹 虚拟恋人模式（待开发）
- 🎮 游戏模式（待开发）
- 📖 小说模式（待开发）

#### 🔧 工具插件 (Tools)
可插拔的小功能，如：
- 📜 剧本选择器（已完成）
- 🎲 骰子工具（待开发）
- 🎨 AI绘图（待开发）
- 🗣️ 语音工具（待开发）

#### 🎨 共享组件 (Shared)
可复用的UI组件：
- ✅ MessageBubble - 消息气泡
- ✅ ChatInput - 输入框
- ✅ MarkdownRenderer - Markdown渲染
- ✅ EmptyState - 空状态

## 🚀 立即开始

### 启动应用

```bash
# 安装依赖（如果还没有）
npm install

# 开发模式
npm run dev

# 构建生产版本
npm run build
```

### 第一次使用

1. **启动应用** - 运行 `npm run dev`
2. **配置API** - 点击右上角⚙️设置按钮，配置API Key
3. **开始对话** - 在输入框输入消息，开始聊天！
4. **切换模式** - 使用顶部的模式选择器（未来会有更多模式）

## 📚 开发新功能

### 开发新模式（5分钟上手）

1. **创建目录**
```bash
src/modes/YourMode/
├── index.vue      # 主组件
└── plugin.js      # 插件配置
```

2. **编写插件配置**
```javascript
// plugin.js
export default {
  id: 'your-mode',
  name: '你的模式',
  description: '模式描述',
  icon: 'ChatDotRound',
  component: YourMode
};
```

3. **实现组件**
```vue
<template>
  <div class="your-mode">
    <!-- 使用共享组件 -->
    <MessageBubble v-for="msg in messages" :key="msg.id" v-bind="msg" />
    <ChatInput @send="handleSend" />
  </div>
</template>

<script>
import { MessageBubble, ChatInput } from '@/shared/components';
import { callAiModel } from '@/core/services/aiService';

export default {
  name: 'YourMode',
  components: { MessageBubble, ChatInput },
  // ... 你的逻辑
};
</script>
```

4. **注册插件**
```javascript
// src/modes/index.js
import YourMode from './YourMode/plugin';

export function registerAllModes() {
  pluginSystem.register(StandardChatMode);
  pluginSystem.register(YourMode);  // 添加这行
}
```

5. **完成！** 刷新页面即可在模式选择器中看到你的新模式

### 开发新工具（3分钟上手）

1. **创建工具**
```bash
src/tools/YourTool/
├── index.vue      # UI组件
└── tool.js        # 工具配置
```

2. **实现并注册** - 参考 `ScriptSelectorTool`

## 📖 完整文档

- **[架构说明](./架构说明.md)** - 详细的架构设计
- **[插件开发示例](./插件开发示例.md)** - 虚拟恋人、骰子等完整示例
- **[重构指南](../REFACTORING_GUIDE.md)** - 重构细节和变化

## 🎯 推荐的开发路线

### 阶段1：熟悉新架构
- ✅ 运行应用，确保一切正常
- ✅ 浏览代码结构，理解各部分职责
- ✅ 阅读文档，了解插件开发流程

### 阶段2：开发第一个插件
建议从简单的开始：
- 🌹 **虚拟恋人模式**（参考示例文档）
  - 好感度系统
  - 简单的状态面板
  - 复用现有的对话组件

### 阶段3：添加工具
- 🎲 **骰子工具**（参考示例文档）
  - 简单的UI
  - 结果插入到输入框
  - 在多个模式中复用

### 阶段4：高级功能
- 📊 **状态持久化**
- 🎨 **自定义主题**
- 🌐 **多语言支持**
- 📦 **插件导入/导出**

## 💡 实用技巧

### 1. 复用共享组件
```javascript
// 推荐
import { MessageBubble, ChatInput } from '@/shared/components';

// 不推荐（重新实现）
// 自己写一个消息气泡组件
```

### 2. 使用核心AI服务
```javascript
// 推荐
import { callAiModel } from '@/core/services/aiService';

// 不推荐（直接调用API）
// fetch(apiUrl, ...)
```

### 3. 利用插件配置
```javascript
export default {
  props: {
    config: Object  // 自动接收全局配置
  },
  computed: {
    apiKey() {
      return this.config.apiKey;  // 无需自己管理
    }
  }
};
```

### 4. 事件通信
```vue
<template>
  <button @click="$emit('open-settings')">打开设置</button>
</template>

<script>
export default {
  emits: ['open-settings']  // 声明事件
};
</script>
```

## 🐛 常见问题

### Q: 原有的对话功能还在吗？
A: 是的！现在作为"标准对话模式"插件存在，功能完全保留。

### Q: 我的对话历史会丢失吗？
A: 不会！所有数据自动迁移，无需手动操作。

### Q: 如何添加新模式？
A: 参考 `docs/插件开发示例.md` 中的虚拟恋人模式示例。

### Q: 工具和模式有什么区别？
A: 
- **模式**：完整的功能体验（如虚拟恋人、游戏）
- **工具**：可插拔的小功能（如骰子、生图），可在多个模式中复用

### Q: 性能会变差吗？
A: 不会！插件采用懒加载，只有使用时才加载。

## 🎉 开始创造！

现在你已经掌握了基础知识，开始开发你的第一个插件吧！

```bash
# 开发模式（热重载）
npm run dev

# 编写代码
# 刷新浏览器
# 享受创造的乐趣！
```

需要灵感？查看 `docs/插件开发示例.md` 中的完整示例：
- 🌹 虚拟恋人模式（带好感度系统）
- 🎲 骰子工具（支持多种规则）

**祝开发愉快！** 🚀✨

